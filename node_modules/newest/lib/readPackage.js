"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.readPackage = readPackage;

var _fs = require("fs");

var _util = require("util");

var _detectIndent = require("./detectIndent");

const aReadFile = (0, _util.promisify)(_fs.readFile);

async function readPackage() {
  try {
    const text = await aReadFile("./package.json", "utf8");
    const indent = (0, _detectIndent.detectIndent)(text);
    const pkg = JSON.parse(await aReadFile("./package.json", "utf8"));
    return {
      indent,
      pkg
    };
  } catch (err) {
    if (err.code === "ENOENT") throw new Error(`No "package.json" found.`);else throw new Error(`Invalid package.json file`);
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZWFkUGFja2FnZS50cyJdLCJuYW1lcyI6WyJhUmVhZEZpbGUiLCJyZWFkRmlsZSIsInJlYWRQYWNrYWdlIiwidGV4dCIsImluZGVudCIsInBrZyIsIkpTT04iLCJwYXJzZSIsImVyciIsImNvZGUiLCJFcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUdBLE1BQU1BLFNBQVMsR0FBRyxxQkFBVUMsWUFBVixDQUFsQjs7QUFFTyxlQUFlQyxXQUFmLEdBR0o7QUFDRCxNQUFJO0FBQ0YsVUFBTUMsSUFBSSxHQUFHLE1BQU1ILFNBQVMsQ0FBQyxnQkFBRCxFQUFtQixNQUFuQixDQUE1QjtBQUNBLFVBQU1JLE1BQU0sR0FBRyxnQ0FBYUQsSUFBYixDQUFmO0FBQ0EsVUFBTUUsR0FBRyxHQUFHQyxJQUFJLENBQUNDLEtBQUwsQ0FBVyxNQUFNUCxTQUFTLENBQUMsZ0JBQUQsRUFBbUIsTUFBbkIsQ0FBMUIsQ0FBWjtBQUVBLFdBQU87QUFBRUksTUFBQUEsTUFBRjtBQUFVQyxNQUFBQTtBQUFWLEtBQVA7QUFDRCxHQU5ELENBTUUsT0FBT0csR0FBUCxFQUFZO0FBQ1osUUFBSUEsR0FBRyxDQUFDQyxJQUFKLEtBQWEsUUFBakIsRUFBMkIsTUFBTSxJQUFJQyxLQUFKLENBQVcsMEJBQVgsQ0FBTixDQUEzQixLQUNLLE1BQU0sSUFBSUEsS0FBSixDQUFXLDJCQUFYLENBQU47QUFDTjtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVhZEZpbGUgfSBmcm9tICdmcyc7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcbmltcG9ydCB7IGRldGVjdEluZGVudCB9IGZyb20gJy4vZGV0ZWN0SW5kZW50JztcbmltcG9ydCB7IElQYWNrYWdlIH0gZnJvbSAnLi90eXBlcy9JUGFja2FnZSc7XG5cbmNvbnN0IGFSZWFkRmlsZSA9IHByb21pc2lmeShyZWFkRmlsZSk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWFkUGFja2FnZSgpOiBQcm9taXNlPHtcbiAgaW5kZW50OiBzdHJpbmc7XG4gIHBrZzogSVBhY2thZ2U7XG59PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdGV4dCA9IGF3YWl0IGFSZWFkRmlsZShcIi4vcGFja2FnZS5qc29uXCIsIFwidXRmOFwiKTtcbiAgICBjb25zdCBpbmRlbnQgPSBkZXRlY3RJbmRlbnQodGV4dCk7XG4gICAgY29uc3QgcGtnID0gSlNPTi5wYXJzZShhd2FpdCBhUmVhZEZpbGUoXCIuL3BhY2thZ2UuanNvblwiLCBcInV0ZjhcIikpO1xuXG4gICAgcmV0dXJuIHsgaW5kZW50LCBwa2cgfTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgaWYgKGVyci5jb2RlID09PSBcIkVOT0VOVFwiKSB0aHJvdyBuZXcgRXJyb3IoYE5vIFwicGFja2FnZS5qc29uXCIgZm91bmQuYCk7XG4gICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgcGFja2FnZS5qc29uIGZpbGVgKTtcbiAgfVxufVxuIl19