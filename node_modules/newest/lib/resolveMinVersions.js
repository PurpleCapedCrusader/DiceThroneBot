"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.resolveMinVersions = resolveMinVersions;

var _semver = _interopRequireDefault(require("semver"));

var _IPackage = require("./types/IPackage");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function resolveMinVersions(pkg) {
  const minVersions = new Map();

  for (const key of _IPackage.DEPENDENCY_KEYS) {
    const versions = pkg[key];
    if (versions === undefined) continue;

    for (const name of Object.keys(versions)) {
      const version = versions[name];

      if (!/^\^\S+$/.test(version)) {
        continue;
      }

      const minVersion = _semver.default.minVersion(version);

      const currentMinVersion = minVersions.get(name);

      if (minVersion && (!currentMinVersion || _semver.default.lt(minVersion, currentMinVersion, true))) {
        minVersions.set(name, minVersion);
      }
    }
  }

  return minVersions;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXNvbHZlTWluVmVyc2lvbnMudHMiXSwibmFtZXMiOlsicmVzb2x2ZU1pblZlcnNpb25zIiwicGtnIiwibWluVmVyc2lvbnMiLCJNYXAiLCJrZXkiLCJERVBFTkRFTkNZX0tFWVMiLCJ2ZXJzaW9ucyIsInVuZGVmaW5lZCIsIm5hbWUiLCJPYmplY3QiLCJrZXlzIiwidmVyc2lvbiIsInRlc3QiLCJtaW5WZXJzaW9uIiwic2VtdmVyIiwiY3VycmVudE1pblZlcnNpb24iLCJnZXQiLCJsdCIsInNldCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7O0FBRU8sU0FBU0Esa0JBQVQsQ0FBNEJDLEdBQTVCLEVBQWdFO0FBQ3JFLFFBQU1DLFdBQVcsR0FBRyxJQUFJQyxHQUFKLEVBQXBCOztBQUVBLE9BQUssTUFBTUMsR0FBWCxJQUFrQkMseUJBQWxCLEVBQW1DO0FBQ2pDLFVBQU1DLFFBQVEsR0FBR0wsR0FBRyxDQUFDRyxHQUFELENBQXBCO0FBRUEsUUFBSUUsUUFBUSxLQUFLQyxTQUFqQixFQUE0Qjs7QUFFNUIsU0FBSyxNQUFNQyxJQUFYLElBQW1CQyxNQUFNLENBQUNDLElBQVAsQ0FBWUosUUFBWixDQUFuQixFQUEwQztBQUN4QyxZQUFNSyxPQUFPLEdBQUdMLFFBQVEsQ0FBQ0UsSUFBRCxDQUF4Qjs7QUFFQSxVQUFJLENBQUMsVUFBVUksSUFBVixDQUFlRCxPQUFmLENBQUwsRUFBOEI7QUFDNUI7QUFDRDs7QUFFRCxZQUFNRSxVQUFVLEdBQUdDLGdCQUFPRCxVQUFQLENBQWtCRixPQUFsQixDQUFuQjs7QUFDQSxZQUFNSSxpQkFBaUIsR0FBR2IsV0FBVyxDQUFDYyxHQUFaLENBQWdCUixJQUFoQixDQUExQjs7QUFFQSxVQUNFSyxVQUFVLEtBQ1QsQ0FBQ0UsaUJBQUQsSUFBc0JELGdCQUFPRyxFQUFQLENBQVVKLFVBQVYsRUFBc0JFLGlCQUF0QixFQUF5QyxJQUF6QyxDQURiLENBRFosRUFHRTtBQUNBYixRQUFBQSxXQUFXLENBQUNnQixHQUFaLENBQWdCVixJQUFoQixFQUFzQkssVUFBdEI7QUFDRDtBQUNGO0FBQ0Y7O0FBRUQsU0FBT1gsV0FBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHNlbXZlciwgeyBTZW1WZXIgfSBmcm9tIFwic2VtdmVyXCI7XG5pbXBvcnQgeyBERVBFTkRFTkNZX0tFWVMsIElQYWNrYWdlIH0gZnJvbSBcIi4vdHlwZXMvSVBhY2thZ2VcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVNaW5WZXJzaW9ucyhwa2c6IElQYWNrYWdlKTogTWFwPHN0cmluZywgU2VtVmVyPiB7XG4gIGNvbnN0IG1pblZlcnNpb25zID0gbmV3IE1hcDxzdHJpbmcsIFNlbVZlcj4oKTtcblxuICBmb3IgKGNvbnN0IGtleSBvZiBERVBFTkRFTkNZX0tFWVMpIHtcbiAgICBjb25zdCB2ZXJzaW9ucyA9IHBrZ1trZXldO1xuXG4gICAgaWYgKHZlcnNpb25zID09PSB1bmRlZmluZWQpIGNvbnRpbnVlO1xuXG4gICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5rZXlzKHZlcnNpb25zKSkge1xuICAgICAgY29uc3QgdmVyc2lvbiA9IHZlcnNpb25zW25hbWVdO1xuXG4gICAgICBpZiAoIS9eXFxeXFxTKyQvLnRlc3QodmVyc2lvbikpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG1pblZlcnNpb24gPSBzZW12ZXIubWluVmVyc2lvbih2ZXJzaW9uKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRNaW5WZXJzaW9uID0gbWluVmVyc2lvbnMuZ2V0KG5hbWUpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIG1pblZlcnNpb24gJiZcbiAgICAgICAgKCFjdXJyZW50TWluVmVyc2lvbiB8fCBzZW12ZXIubHQobWluVmVyc2lvbiwgY3VycmVudE1pblZlcnNpb24sIHRydWUpKVxuICAgICAgKSB7XG4gICAgICAgIG1pblZlcnNpb25zLnNldChuYW1lLCBtaW5WZXJzaW9uKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWluVmVyc2lvbnM7XG59XG4iXX0=