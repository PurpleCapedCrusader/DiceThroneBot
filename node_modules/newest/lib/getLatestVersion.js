"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getLatestVersion = getLatestVersion;

var _packageJson = _interopRequireDefault(require("package-json"));

var _semver = require("semver");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const cache = new Map();

async function getLatestVersion(packageName) {
  const cached = cache.get(packageName);

  if (cached) {
    return cached;
  }

  const {
    versions
  } = await (0, _packageJson.default)(packageName, {
    allVersions: true
  });
  const version = Object.keys(versions).filter(v => !v.includes("-")).sort(_semver.compare).slice(-1)[0];
  cache.set(packageName, version);
  return version;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9nZXRMYXRlc3RWZXJzaW9uLnRzIl0sIm5hbWVzIjpbImNhY2hlIiwiTWFwIiwiZ2V0TGF0ZXN0VmVyc2lvbiIsInBhY2thZ2VOYW1lIiwiY2FjaGVkIiwiZ2V0IiwidmVyc2lvbnMiLCJhbGxWZXJzaW9ucyIsInZlcnNpb24iLCJPYmplY3QiLCJrZXlzIiwiZmlsdGVyIiwidiIsImluY2x1ZGVzIiwic29ydCIsImNvbXBhcmUiLCJzbGljZSIsInNldCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7O0FBRUEsTUFBTUEsS0FBSyxHQUFHLElBQUlDLEdBQUosRUFBZDs7QUFFTyxlQUFlQyxnQkFBZixDQUNMQyxXQURLLEVBRXdCO0FBQzdCLFFBQU1DLE1BQU0sR0FBR0osS0FBSyxDQUFDSyxHQUFOLENBQVVGLFdBQVYsQ0FBZjs7QUFFQSxNQUFJQyxNQUFKLEVBQVk7QUFDVixXQUFPQSxNQUFQO0FBQ0Q7O0FBRUQsUUFBTTtBQUFFRSxJQUFBQTtBQUFGLE1BQWUsTUFBTSwwQkFBZUgsV0FBZixFQUE0QjtBQUNyREksSUFBQUEsV0FBVyxFQUFFO0FBRHdDLEdBQTVCLENBQTNCO0FBSUEsUUFBTUMsT0FBTyxHQUFHQyxNQUFNLENBQUNDLElBQVAsQ0FBWUosUUFBWixFQUNiSyxNQURhLENBQ0xDLENBQUQsSUFBTyxDQUFDQSxDQUFDLENBQUNDLFFBQUYsQ0FBVyxHQUFYLENBREYsRUFFYkMsSUFGYSxDQUVSQyxlQUZRLEVBR2JDLEtBSGEsQ0FHUCxDQUFDLENBSE0sRUFHSCxDQUhHLENBQWhCO0FBS0FoQixFQUFBQSxLQUFLLENBQUNpQixHQUFOLENBQVVkLFdBQVYsRUFBdUJLLE9BQXZCO0FBRUEsU0FBT0EsT0FBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGdldFBhY2thZ2VJbmZvIGZyb20gJ3BhY2thZ2UtanNvbic7XG5pbXBvcnQgeyBjb21wYXJlIH0gZnJvbSAnc2VtdmVyJztcblxuY29uc3QgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nIHwgdW5kZWZpbmVkPigpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TGF0ZXN0VmVyc2lvbihcbiAgcGFja2FnZU5hbWU6IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgY29uc3QgY2FjaGVkID0gY2FjaGUuZ2V0KHBhY2thZ2VOYW1lKTtcblxuICBpZiAoY2FjaGVkKSB7XG4gICAgcmV0dXJuIGNhY2hlZDtcbiAgfVxuXG4gIGNvbnN0IHsgdmVyc2lvbnMgfSA9IGF3YWl0IGdldFBhY2thZ2VJbmZvKHBhY2thZ2VOYW1lLCB7XG4gICAgYWxsVmVyc2lvbnM6IHRydWUsXG4gIH0pO1xuXG4gIGNvbnN0IHZlcnNpb24gPSBPYmplY3Qua2V5cyh2ZXJzaW9ucylcbiAgICAuZmlsdGVyKCh2KSA9PiAhdi5pbmNsdWRlcyhcIi1cIikpXG4gICAgLnNvcnQoY29tcGFyZSlcbiAgICAuc2xpY2UoLTEpWzBdO1xuXG4gIGNhY2hlLnNldChwYWNrYWdlTmFtZSwgdmVyc2lvbik7XG5cbiAgcmV0dXJuIHZlcnNpb247XG59XG4iXX0=