"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.applyUpdates = applyUpdates;

var _fs = require("fs");

var _util = require("util");

var _IPackage = require("./types/IPackage");

const aWriteFile = (0, _util.promisify)(_fs.writeFile);

async function applyUpdates(indent, pkg, versions) {
  pkg = { ...pkg
  };

  for (const key of _IPackage.DEPENDENCY_KEYS) {
    if (pkg[key]) {
      pkg[key] = { ...pkg[key]
      };

      for (const name of versions.keys()) {
        if (pkg[key][name]) {
          pkg[key][name] = `^${versions.get(name)}`;
        }
      }
    }
  }

  await aWriteFile("./package.json", JSON.stringify(pkg, null, indent));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHBseVVwZGF0ZXMudHMiXSwibmFtZXMiOlsiYVdyaXRlRmlsZSIsIndyaXRlRmlsZSIsImFwcGx5VXBkYXRlcyIsImluZGVudCIsInBrZyIsInZlcnNpb25zIiwia2V5IiwiREVQRU5ERU5DWV9LRVlTIiwibmFtZSIsImtleXMiLCJnZXQiLCJKU09OIiwic3RyaW5naWZ5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUE7O0FBQ0E7O0FBRUEsTUFBTUEsVUFBVSxHQUFHLHFCQUFVQyxhQUFWLENBQW5COztBQUVPLGVBQWVDLFlBQWYsQ0FDTEMsTUFESyxFQUVMQyxHQUZLLEVBR0xDLFFBSEssRUFJTDtBQUNBRCxFQUFBQSxHQUFHLEdBQUcsRUFBRSxHQUFHQTtBQUFMLEdBQU47O0FBRUEsT0FBSyxNQUFNRSxHQUFYLElBQWtCQyx5QkFBbEIsRUFBbUM7QUFDakMsUUFBSUgsR0FBRyxDQUFDRSxHQUFELENBQVAsRUFBYztBQUNaRixNQUFBQSxHQUFHLENBQUNFLEdBQUQsQ0FBSCxHQUFXLEVBQUUsR0FBR0YsR0FBRyxDQUFDRSxHQUFEO0FBQVIsT0FBWDs7QUFFQSxXQUFLLE1BQU1FLElBQVgsSUFBbUJILFFBQVEsQ0FBQ0ksSUFBVCxFQUFuQixFQUFvQztBQUNsQyxZQUFJTCxHQUFHLENBQUNFLEdBQUQsQ0FBSCxDQUFVRSxJQUFWLENBQUosRUFBcUI7QUFDbkJKLFVBQUFBLEdBQUcsQ0FBQ0UsR0FBRCxDQUFILENBQVVFLElBQVYsSUFBbUIsSUFBR0gsUUFBUSxDQUFDSyxHQUFULENBQWFGLElBQWIsQ0FBbUIsRUFBekM7QUFDRDtBQUNGO0FBQ0Y7QUFDRjs7QUFFRCxRQUFNUixVQUFVLENBQUMsZ0JBQUQsRUFBbUJXLElBQUksQ0FBQ0MsU0FBTCxDQUFlUixHQUFmLEVBQW9CLElBQXBCLEVBQTBCRCxNQUExQixDQUFuQixDQUFoQjtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgd3JpdGVGaWxlIH0gZnJvbSBcImZzXCI7XG5pbXBvcnQgeyBTZW1WZXIgfSBmcm9tIFwic2VtdmVyXCI7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tIFwidXRpbFwiO1xuaW1wb3J0IHsgREVQRU5ERU5DWV9LRVlTLCBJUGFja2FnZSB9IGZyb20gXCIuL3R5cGVzL0lQYWNrYWdlXCI7XG5cbmNvbnN0IGFXcml0ZUZpbGUgPSBwcm9taXNpZnkod3JpdGVGaWxlKTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGx5VXBkYXRlcyhcbiAgaW5kZW50OiBzdHJpbmcsXG4gIHBrZzogSVBhY2thZ2UsXG4gIHZlcnNpb25zOiBNYXA8c3RyaW5nLCBTZW1WZXI+XG4pIHtcbiAgcGtnID0geyAuLi5wa2cgfTtcblxuICBmb3IgKGNvbnN0IGtleSBvZiBERVBFTkRFTkNZX0tFWVMpIHtcbiAgICBpZiAocGtnW2tleV0pIHtcbiAgICAgIHBrZ1trZXldID0geyAuLi5wa2dba2V5XSB9O1xuXG4gICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgdmVyc2lvbnMua2V5cygpKSB7XG4gICAgICAgIGlmIChwa2dba2V5XSFbbmFtZV0pIHtcbiAgICAgICAgICBwa2dba2V5XSFbbmFtZV0gPSBgXiR7dmVyc2lvbnMuZ2V0KG5hbWUpfWA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhd2FpdCBhV3JpdGVGaWxlKFwiLi9wYWNrYWdlLmpzb25cIiwgSlNPTi5zdHJpbmdpZnkocGtnLCBudWxsLCBpbmRlbnQpKTtcbn1cbiJdfQ==